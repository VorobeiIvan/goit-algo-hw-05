from collections import defaultdict
import timeit

# –ê–ª–≥–æ—Ä–∏—Ç–º –ë–æ—î—Ä–∞-–ú—É—Ä–∞
def boyer_moore(text, pattern):
    m, n = len(pattern), len(text)
    if m == 0:
        return -1
    
    last = defaultdict(lambda: -1)
    for i in range(m):
        last[pattern[i]] = i
    
    i = m - 1 
    j = m - 1 
    while i < n:
        if text[i] == pattern[j]:
            if j == 0:
                return i
            i -= 1
            j -= 1
        else:
            i += m - min(j, 1 + last[text[i]])
            j = m - 1
    return -1

# –ê–ª–≥–æ—Ä–∏—Ç–º –ö–Ω—É—Ç–∞-–ú–æ—Ä—Ä—ñ—Å–∞-–ü—Ä–∞—Ç—Ç–∞
def kmp_search(text, pattern):
    m, n = len(pattern), len(text)
    lps = [0] * m
    j = 0
    
    length, i = 0, 1
    while i < m:
        if pattern[i] == pattern[length]:
            length += 1
            lps[i] = length
            i += 1
        else:
            if length != 0:
                length = lps[length - 1]
            else:
                lps[i] = 0
                i += 1
    
    i = 0  
    while i < n:
        if pattern[j] == text[i]:
            i += 1
            j += 1
        if j == m:
            return i - j
        elif i < n and pattern[j] != text[i]:
            j = lps[j - 1] if j > 0 else 0
            i += 1
    return -1

# –ê–ª–≥–æ—Ä–∏—Ç–º –†–∞–±—ñ–Ω–∞-–ö–∞—Ä–ø–∞
def rabin_karp(text, pattern, prime=101):
    m, n = len(pattern), len(text)
    d = 256  
    h = pow(d, m - 1) % prime
    p = 0  
    t = 0  
    
    for i in range(m):
        p = (d * p + ord(pattern[i])) % prime
        t = (d * t + ord(text[i])) % prime
    
    for i in range(n - m + 1):
        if p == t:
            if text[i:i + m] == pattern:
                return i
        if i < n - m:
            t = (d * (t - ord(text[i]) * h) + ord(text[i + m])) % prime
            if t < 0:
                t += prime
    return -1


with open("article_1.txt", "r", encoding="utf-8") as f:
    text1 = f.read()
with open("article_2.txt", "r", encoding="utf-8") as f:
    text2 = f.read()


existing_substring = "–∞–ª–≥–æ—Ä–∏—Ç–º"
non_existing_substring = "—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"


for text, name in [(text1, "Article 1"), (text2, "Article 2")]:
    print(f"Testing on {name}")
    for search_func in [boyer_moore, kmp_search, rabin_karp]:
        for substring in [existing_substring, non_existing_substring]:
            time_taken = timeit.timeit(lambda: search_func(text, substring), number=10)
            print(f"{search_func.__name__} ({substring}): {time_taken:.6f} sec")

'''
–í–∏—Å–Ω–æ–≤–∫–∏ —â–æ–¥–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –ø–æ—à—É–∫—É –ø—ñ–¥—Ä—è–¥–∫–∞
–ü—ñ—Å–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –ë–æ–π—î—Ä–∞-–ú—É—Ä–∞, –ö–Ω—É—Ç–∞-–ú–æ—Ä—Ä—ñ—Å–∞-–ü—Ä–∞—Ç—Ç–∞ (KMP) —Ç–∞ –†–∞–±—ñ–Ω–∞-–ö–∞—Ä–ø–∞ –Ω–∞ –¥–≤–æ—Ö —Å—Ç–∞—Ç—Ç—è—Ö —ñ–∑ –ø–æ—à—É–∫–æ–º —Å–ª—ñ–≤ "–∞–ª–≥–æ—Ä–∏—Ç–º" —Ç–∞ "—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", –æ—Ç—Ä–∏–º–∞–Ω—ñ —Ç–∞–∫—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:

–ë–æ–π—î—Ä-–ú—É—Ä (Boyer-Moore)

–ù–∞–π—à–≤–∏–¥—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–µ—Ä–µ–¥ —Ç—Ä—å–æ—Ö, –æ—Å–æ–±–ª–∏–≤–æ –ø—Ä–∏ –ø–æ—à—É–∫—É –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–ª—ñ–≤.
–ó–Ω–∞—á–Ω–æ –≤–∏–ø–µ—Ä–µ–¥–∂–∞—î —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è —Å–ª–æ–≤–∞ "–∞–ª–≥–æ—Ä–∏—Ç–º" (–¥–æ 10 —Ä–∞–∑—ñ–≤ —à–≤–∏–¥—à–∏–π –∑–∞ KMP —ñ –†–∞–±—ñ–Ω–∞-–ö–∞—Ä–ø–∞).
–î–ª—è —Å–ª–æ–≤–∞ "—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞" —Ç–∞–∫–æ–∂ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Ö–æ—Ä–æ—à—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, –∞–ª–µ –ø–µ—Ä–µ–≤–∞–≥–∞ –Ω–∞–¥ —ñ–Ω—à–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –º–µ–Ω—à –≤–∏—Ä–∞–∂–µ–Ω–∞.
–ö–Ω—É—Ç-–ú–æ—Ä—Ä—ñ—Å-–ü—Ä–∞—Ç—Ç (KMP)

–í—ñ–¥—á—É—Ç–Ω–æ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–π –∑–∞ –ë–æ–π—î—Ä–∞-–ú—É—Ä–∞, –æ—Å–æ–±–ª–∏–≤–æ –Ω–∞ –¥–æ–≤—à–∏—Ö —Å–ª–æ–≤–∞—Ö.
–ß–∞—Å –ø–æ—à—É–∫—É –¥–ª—è "—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞" –º–∞–π–∂–µ –≤ 10 —Ä–∞–∑—ñ–≤ –≥—ñ—Ä—à–∏–π, –Ω—ñ–∂ –¥–ª—è "–∞–ª–≥–æ—Ä–∏—Ç–º", —â–æ –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —á—É—Ç–ª–∏–≤—ñ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—É –¥–æ –¥–æ–≤–∂–∏–Ω–∏ —Ç–∞ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –ø—ñ–¥—Ä—è–¥–∫–∞.
–ü—Ä–æ—Ç–µ –≤—Å–µ —â–µ —à–≤–∏–¥—à–∏–π –∑–∞ –†–∞–±—ñ–Ω–∞-–ö–∞—Ä–ø–∞ —É –±—ñ–ª—å—à–æ—Å—Ç—ñ –≤–∏–ø–∞–¥–∫—ñ–≤.
–†–∞–±—ñ–Ω-–ö–∞—Ä–ø (Rabin-Karp)

–ù–∞–π–ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–π —Å–µ—Ä–µ–¥ —Ç—Ä—å–æ—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤.
–ß–∞—Å –ø–æ—à—É–∫—É —Å–∏–ª—å–Ω–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –¥–æ–≤–∂–∏–Ω–∏ –ø—ñ–¥—Ä—è–¥–∫–∞.
–î–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–ª—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–∞–ª–≥–æ—Ä–∏—Ç–º") –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω–∞ –∑ KMP, –∞–ª–µ –¥–ª—è –¥–æ–≤—à–∏—Ö —Å–ª—ñ–≤ ("—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞") –∑–∞—Ç—Ä–∏–º–∫–∞ –∑–Ω–∞—á–Ω–∞.
–ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏
‚úÖ –ë–æ–π—î—Ä-–ú—É—Ä ‚Äî –Ω–∞–π–∫—Ä–∞—â–∏–π –≤–∏–±—ñ—Ä –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É –≤ —Ç–µ–∫—Å—Ç–∞—Ö, –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ –ø—ñ–¥—Ä—è–¥–∫–∏ –Ω–µ –Ω–∞–¥—Ç–æ –¥–æ–≤–≥—ñ.
‚úÖ KMP –ø—Ä–∞—Ü—é—î —Å—Ç–∞–±—ñ–ª—å–Ω–æ, –∞–ª–µ –Ω–µ —Ç–∞–∫ —à–≤–∏–¥–∫–æ, —è–∫ –ë–æ–π—î—Ä-–ú—É—Ä.
‚ùå –†–∞–±—ñ–Ω-–ö–∞—Ä–ø –º–µ–Ω—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π, –æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è –¥–æ–≤—à–∏—Ö –ø—ñ–¥—Ä—è–¥–∫—ñ–≤, —ñ –º–æ–∂–µ –ø–æ—Å—Ç—É–ø–∞—Ç–∏—Å—è –Ω–∞–≤—ñ—Ç—å KMP.

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç, –≤–∞—Ä—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ë–æ–π—î—Ä–∞-–ú—É—Ä–∞ –∞–±–æ KMP –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∏ –¥–∞–Ω–∏—Ö. üöÄ

'''